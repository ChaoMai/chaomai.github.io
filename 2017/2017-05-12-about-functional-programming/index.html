<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/default_avatar.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/default_avatar.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;chaomai.github.io&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Mist&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;right&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:false,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:true,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:true,&quot;pangu&quot;:true,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:false,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;Searching...&quot;,&quot;empty&quot;:&quot;We didn&#39;t find any results for the search: ${query}&quot;,&quot;hits_time&quot;:&quot;${hits} results found in ${time} ms&quot;,&quot;hits&quot;:&quot;${hits} results found&quot;}}</script><script src="/js/config.js"></script>
<meta name="description" content="Notes of Functional Programming in Scala and more. Pure Function对于一个函数 f: A &#x3D;&gt; B，如果任何一个值 a: A 都有只有一个 b: B 与之对应，使得 b 仅仅由 a 决定，那么这个函数是纯函数。任何内部或外部状态的改变都不影响 f(a) 的结果。 Referential Transparency引用透明是表达式的属">
<meta property="og:type" content="article">
<meta property="og:title" content="函数式编程相关">
<meta property="og:url" content="https://chaomai.github.io/2017/2017-05-12-about-functional-programming/index.html">
<meta property="og:site_name" content="chaomai&#39;s blog">
<meta property="og:description" content="Notes of Functional Programming in Scala and more. Pure Function对于一个函数 f: A &#x3D;&gt; B，如果任何一个值 a: A 都有只有一个 b: B 与之对应，使得 b 仅仅由 a 决定，那么这个函数是纯函数。任何内部或外部状态的改变都不影响 f(a) 的结果。 Referential Transparency引用透明是表达式的属">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-05-12T01:10:55.000Z">
<meta property="article:modified_time" content="2021-06-27T14:57:29.273Z">
<meta property="article:author" content="Chao Mai">
<meta property="article:tag" content="scala">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://chaomai.github.io/2017/2017-05-12-about-functional-programming/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;en&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;https:&#x2F;&#x2F;chaomai.github.io&#x2F;2017&#x2F;2017-05-12-about-functional-programming&#x2F;&quot;,&quot;path&quot;:&quot;2017&#x2F;2017-05-12-about-functional-programming&#x2F;&quot;,&quot;title&quot;:&quot;函数式编程相关&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>函数式编程相关 | chaomai's blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34179929-2"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{&quot;tracking_id&quot;:&quot;UA-34179929-2&quot;,&quot;only_pageview&quot;:false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="chaomai's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">chaomai's blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
        <li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>Rss</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Pure-Function"><span class="nav-number">1.</span> <span class="nav-text">Pure Function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Referential-Transparency"><span class="nav-number">2.</span> <span class="nav-text">Referential Transparency</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Idempotence%EF%BC%88%E5%B9%82%E7%AD%89%E6%80%A7%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">Idempotence（幂等性）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Currying"><span class="nav-number"></span> <span class="nav-text">Currying</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Currying-%E5%92%8C-Partially-Applied-Function"><span class="nav-number"></span> <span class="nav-text">Currying 和 Partially Applied Function</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#trait-and-class"><span class="nav-number"></span> <span class="nav-text">trait and class</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Functions-and-Methods"><span class="nav-number"></span> <span class="nav-text">Functions and Methods</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Functional-Combinators"><span class="nav-number"></span> <span class="nav-text">Functional Combinators</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PartialFunction-and-Partially-Applied-Function"><span class="nav-number"></span> <span class="nav-text">PartialFunction and Partially Applied Function</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Rank-1-polymorphism-and-Higher-Rank-Polymorphism"><span class="nav-number"></span> <span class="nav-text">Rank-1 polymorphism and Higher-Rank Polymorphism</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Existential-Types"><span class="nav-number"></span> <span class="nav-text">Existential Types</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Algebraic-Data-Type"><span class="nav-number"></span> <span class="nav-text">Algebraic Data Type</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Variant"><span class="nav-number"></span> <span class="nav-text">Variant</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Covariant-and-contravariant"><span class="nav-number">1.</span> <span class="nav-text">Covariant and contravariant</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Covariant-and-Contravariant-Positions"><span class="nav-number">2.</span> <span class="nav-text">Covariant and Contravariant Positions</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Laziness-%E5%92%8C-Non-strictness"><span class="nav-number"></span> <span class="nav-text">Laziness 和 Non-strictness</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Nothing-%E5%92%8C-NotNothing"><span class="nav-number"></span> <span class="nav-text">Nothing 和 NotNothing</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#State-Action-and-FSM"><span class="nav-number"></span> <span class="nav-text">State Action and FSM</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#implicit"><span class="nav-number"></span> <span class="nav-text">implicit</span></a></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Chao Mai</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">85</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/chaomai" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;chaomai" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:loneymai@gmail.com" title="E-Mail → mailto:loneymai@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://steamcommunity.com/id/chaomai" title="Steam → https:&#x2F;&#x2F;steamcommunity.com&#x2F;id&#x2F;chaomai" rel="noopener" target="_blank"><i class="fab fa-steam fa-fw"></i>Steam</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="rss fa-fw"></i>RSS</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://laike9m.com/" title="https:&#x2F;&#x2F;laike9m.com" rel="noopener" target="_blank">laike9m's blog</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://chaomai.github.io/2017/2017-05-12-about-functional-programming/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chao Mai">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chaomai's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          函数式编程相关
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-05-12 09:10:55" itemprop="dateCreated datePublished" datetime="2017-05-12T09:10:55+08:00">2017-05-12</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-06-27 22:57:29" itemprop="dateModified" datetime="2021-06-27T22:57:29+08:00">2021-06-27</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/functional-programming/" itemprop="url" rel="index"><span itemprop="name">functional programming</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2017/2017-05-12-about-functional-programming/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/2017-05-12-about-functional-programming/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Notes of Functional Programming in Scala and more.</p>
<h2 id="Pure-Function"><a href="#Pure-Function" class="headerlink" title="Pure Function"></a>Pure Function</h2><p>对于一个函数 <code>f: A =&gt; B</code>，如果任何一个值 <code>a: A</code> 都有只有一个 <code>b: B</code> 与之对应，使得 <code>b</code> 仅仅由 <code>a</code> 决定，那么这个函数是纯函数。任何内部或外部状态的改变都不影响 <code>f(a)</code> 的结果。</p>
<h2 id="Referential-Transparency"><a href="#Referential-Transparency" class="headerlink" title="Referential Transparency"></a>Referential Transparency</h2><p>引用透明是表达式的属性。如果一个表达式是引用透明的，那么把这个表达式替换为它求值后的结果不会影响程序的行为。引用透明是定义一个纯函数的必要条件。</p>
<p>如果表达式不是引用透明的，那么这个表达式就是有 side-effect（副作用）。根据引用透明的定义，对于一个纯函数函数 <code>f</code>，表达式 <code>f(x)</code> 不会有任何的副作用。</p>
<h2 id="Idempotence（幂等性）"><a href="#Idempotence（幂等性）" class="headerlink" title="Idempotence（幂等性）"></a>Idempotence（幂等性）</h2><p>纯函数的幂等的。</p>
<p>$$<br>\forall x, f(f(x)) = f(x)<br>$$</p>
<h1 id="Currying"><a href="#Currying" class="headerlink" title="Currying"></a>Currying</h1><p>一个 Curryied 函数是，把一个接受多个参数的函数重写为，一个首先接受第一个参数并返回一个函数接受第二个参数…的函数。</p>
<p>例如：foldLeft。</p>
<p><a target="_blank" rel="noopener" href="https://oldfashionedsoftware.com/2009/07/10/scala-code-review-foldleft-and-foldright/">https://oldfashionedsoftware.com/2009/07/10/scala-code-review-foldleft-and-foldright/</a></p>
<h1 id="Currying-和-Partially-Applied-Function"><a href="#Currying-和-Partially-Applied-Function" class="headerlink" title="Currying 和 Partially Applied Function"></a>Currying 和 Partially Applied Function</h1><ul>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/14309501/scala-currying-vs-partially-applied-functions">http://stackoverflow.com/questions/14309501/scala-currying-vs-partially-applied-functions</a></li>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/8650549/using-partial-functions-in-scala-how-does-it-work/8650639#8650639">http://stackoverflow.com/questions/8650549/using-partial-functions-in-scala-how-does-it-work/8650639#8650639</a></li>
</ul>
<h1 id="trait-and-class"><a href="#trait-and-class" class="headerlink" title="trait and class"></a>trait and class</h1><ul>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/1991042/what-is-the-advantage-of-using-abstract-classes-instead-of-traits">http://stackoverflow.com/questions/1991042/what-is-the-advantage-of-using-abstract-classes-instead-of-traits</a></li>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/2005681/difference-between-abstract-class-and-trait">http://stackoverflow.com/questions/2005681/difference-between-abstract-class-and-trait</a></li>
<li><a target="_blank" rel="noopener" href="http://www.artima.com/pins1ed/traits.html#12.7">http://www.artima.com/pins1ed/traits.html#12.7</a></li>
</ul>
<h1 id="Functions-and-Methods"><a href="#Functions-and-Methods" class="headerlink" title="Functions and Methods"></a>Functions and Methods</h1><p>In Scala there is a rather arbitrary distinction between functions defined as <em>methods</em>, which are introduced with the <code>def</code> keyword, and function values, which are the first-class objects we can pass to other functions, put in collections, and so on.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.google.com/search?q=difference+scala+function+method">https://www.google.com/search?q=difference+scala+function+method</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cnblogs.com/shihuc/p/5082701.html">http://www.cnblogs.com/shihuc/p/5082701.html</a></li>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/4839537/functions-vs-methods-in-scala">http://stackoverflow.com/questions/4839537/functions-vs-methods-in-scala</a></li>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/2529184/difference-between-method-and-function-in-scala">http://stackoverflow.com/questions/2529184/difference-between-method-and-function-in-scala</a></li>
<li><a target="_blank" rel="noopener" href="http://jim-mcbeath.blogspot.com/2009/05/scala-functions-vs-methods.html">http://jim-mcbeath.blogspot.com/2009/05/scala-functions-vs-methods.html</a></li>
<li><a target="_blank" rel="noopener" href="https://dzone.com/articles/revealing-scala-magician%E2%80%99s">https://dzone.com/articles/revealing-scala-magician%E2%80%99s</a></li>
<li><a target="_blank" rel="noopener" href="https://tpolecat.github.io/2014/06/09/methods-functions.html">https://tpolecat.github.io/2014/06/09/methods-functions.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.quora.com/What-is-the-difference-between-function-and-method-in-Scala">https://www.quora.com/What-is-the-difference-between-function-and-method-in-Scala</a></li>
<li><a target="_blank" rel="noopener" href="https://softwarecorner.wordpress.com/2013/09/06/scala-methods-and-functions/">https://softwarecorner.wordpress.com/2013/09/06/scala-methods-and-functions/</a></li>
<li><a target="_blank" rel="noopener" href="http://www.marcinkossakowski.com/difference-between-functions-and-methods-in-scala/">http://www.marcinkossakowski.com/difference-between-functions-and-methods-in-scala/</a></li>
<li><a target="_blank" rel="noopener" href="http://japgolly.blogspot.com/2013/10/scala-methods-vs-functions.html">http://japgolly.blogspot.com/2013/10/scala-methods-vs-functions.html</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.vmoroz.com/posts/2016-06-01-scala-should-i-use-a-method-or-a-function.html">http://blog.vmoroz.com/posts/2016-06-01-scala-should-i-use-a-method-or-a-function.html</a></li>
</ul>
<h1 id="Functional-Combinators"><a href="#Functional-Combinators" class="headerlink" title="Functional Combinators"></a>Functional Combinators</h1><ul>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/7533837/explanation-of-combinators-for-the-working-man">Explanation of combinators</a></li>
</ul>
<p><code>List(1, 2, 3) map squared</code>把函数<code>squared</code>应用到了<code>List(1, 2, 3)</code>的每个元素上，并返回一个新的List。这个操作叫做map组合子（map combinators）。</p>
<h1 id="PartialFunction-and-Partially-Applied-Function"><a href="#PartialFunction-and-Partially-Applied-Function" class="headerlink" title="PartialFunction and Partially Applied Function"></a>PartialFunction and Partially Applied Function</h1><h1 id="Rank-1-polymorphism-and-Higher-Rank-Polymorphism"><a href="#Rank-1-polymorphism-and-Higher-Rank-Polymorphism" class="headerlink" title="Rank-1 polymorphism and Higher-Rank Polymorphism"></a>Rank-1 polymorphism and Higher-Rank Polymorphism</h1><ul>
<li><a target="_blank" rel="noopener" href="https://apocalisp.wordpress.com/2010/07/02/higher-rank-polymorphism-in-scala/">https://apocalisp.wordpress.com/2010/07/02/higher-rank-polymorphism-in-scala/</a><ul>
<li>related:</li>
<li><a target="_blank" rel="noopener" href="https://apocalisp.wordpress.com/2010/10/26/type-level-programming-in-scala-part-7-natural-transformation%C2%A0literals/">https://apocalisp.wordpress.com/2010/10/26/type-level-programming-in-scala-part-7-natural-transformation%C2%A0literals/</a></li>
<li><a target="_blank" rel="noopener" href="https://apocalisp.wordpress.com/2011/03/20/towards-an-effect-system-in-scala-part-1/">https://apocalisp.wordpress.com/2011/03/20/towards-an-effect-system-in-scala-part-1/</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://existentialtype.net/2008/03/09/higher-rank-impredicative-polymorphism-in-scala/">http://existentialtype.net/2008/03/09/higher-rank-impredicative-polymorphism-in-scala/</a></li>
</ul>
<h1 id="Existential-Types"><a href="#Existential-Types" class="headerlink" title="Existential Types"></a>Existential Types</h1><ul>
<li><a target="_blank" rel="noopener" href="http://www.drmaciver.com/2008/03/existential-types-in-scala/">http://www.drmaciver.com/2008/03/existential-types-in-scala/</a></li>
</ul>
<h1 id="Algebraic-Data-Type"><a href="#Algebraic-Data-Type" class="headerlink" title="Algebraic Data Type"></a>Algebraic Data Type</h1><ul>
<li><a target="_blank" rel="noopener" href="http://tpolecat.github.io/presentations/algebraic_types.html">http://tpolecat.github.io/presentations/algebraic_types.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=YScIPA8RbVE">https://www.youtube.com/watch?v=YScIPA8RbVE</a></li>
</ul>
<h1 id="Variant"><a href="#Variant" class="headerlink" title="Variant"></a>Variant</h1><h2 id="Covariant-and-contravariant"><a href="#Covariant-and-contravariant" class="headerlink" title="Covariant and contravariant"></a>Covariant and contravariant</h2><p>对于所有类型<code>X</code>和<code>Y</code>，以及类型<code>Co[+A]</code>，<code>Ctr[-A]</code>，<code>Iv[A]</code>。如果X是Y的子类，</p>
<p>covariant：<code>Co[X]</code>是<code>Co[Y]</code>的子类。在类型参数A前加上+表示 covariant。<br>contravariant：<code>Ctr[Y]</code>是<code>Ctr[X]</code>的子类。在类型参数A前加上-表示 contravariant。<br>invariant：<code>Iv[X]</code>和<code>Iv[Y]</code>无关。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌───┐     ┌───────┐     ┌───────┐</span><br><span class="line">│ Y │     │ Co[Y] │     │Ctr[X] │</span><br><span class="line">└───┘     └───────┘     └───────┘</span><br><span class="line">  ▲           ▲             ▲</span><br><span class="line">  │           │             │</span><br><span class="line">  │           │             │</span><br><span class="line">┌───┐     ┌───────┐     ┌───────┐</span><br><span class="line">│ X │     │ Co[X] │     │Ctr[Y] │</span><br><span class="line">└───┘     └───────┘     └───────┘</span><br></pre></td></tr></table></figure>

<p>表述 covariant 的另一种方式是，在所有上下文中，都可安全的把<code>A</code>转换为<code>A</code>父类。contravariant 类似。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> sound = <span class="string">&quot;rustle&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> sound = <span class="string">&quot;call&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chicken</span> <span class="keyword">extends</span> <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> sound = <span class="string">&quot;cluck&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">covariant1</span>[+<span class="type">A</span>]</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="comment">// error:</span></span></span><br><span class="line"><span class="class"><span class="comment">// val covariant_b1: covariant1[Bird] = new covariant1[Animal]</span></span></span><br><span class="line"><span class="class"><span class="title">val</span> <span class="title">variant_b2</span></span>: variant1[<span class="type">Bird</span>] = <span class="keyword">new</span> variant1[<span class="type">Chicken</span>]</span><br><span class="line">                │            │       │               │</span><br><span class="line">                └────────────┘       └───────────────┘</span><br><span class="line">                      ▲                       │</span><br><span class="line">                      └───────────────────────┘</span><br><span class="line">                           to supper <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">contravariant2</span>[-<span class="type">A</span>]</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">val</span> <span class="title">contravariant_b3</span></span>: contravariant2[<span class="type">Bird</span>] = <span class="keyword">new</span> contravariant2[<span class="type">Animal</span>]</span><br><span class="line"><span class="comment">// error:</span></span><br><span class="line"><span class="comment">// val contravariant_b4: contravariant2[Bird] = new contravariant2[Chicken]</span></span><br></pre></td></tr></table></figure>


<h2 id="Covariant-and-Contravariant-Positions"><a href="#Covariant-and-Contravariant-Positions" class="headerlink" title="Covariant and Contravariant Positions"></a>Covariant and Contravariant Positions</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Function1</span> [-<span class="type">T1</span>, +<span class="type">R</span>] <span class="keyword">extends</span> <span class="title">AnyRef</span></span></span><br></pre></td></tr></table></figure>

<p>以函数为例，</p>
<p>contravariant (positive) position：一个类型在函数参数的类型中。更一般的来说，是函数所使用的值的类型。<br>covariant (negative) position：一个类型在函数结果的类型中。更一般的来说，是函数产生的值的类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">                 ┌────────────────────────┐</span><br><span class="line">                 │ contravariant position │</span><br><span class="line">                 └────────────────────────┘</span><br><span class="line">                              ▲</span><br><span class="line">           ┌──────────────────┘</span><br><span class="line">           │</span><br><span class="line">def foo(a: A): B</span><br><span class="line">               │</span><br><span class="line">               └────────────┐</span><br><span class="line">                            ▼</span><br><span class="line">                 ┌────────────────────┐</span><br><span class="line">                 │ covariant position │</span><br><span class="line">                 └────────────────────┘</span><br></pre></td></tr></table></figure>

<p>对于高阶函数，从外层向内分析。类型最终是什么 position 由分析过程中，各个类型的“累加”得到。就函数 <code>foo</code> 而言，<code>A =&gt; B</code> 是在 contravariant position；就函数 <code>f</code> 而言， <code>A</code> 是在 contravariant position，<code>B</code> 是在 covariant position。因此，最终 <code>A</code> 是在 covariant position（可以理解为两个 negative position 合并，负负得正），而 <code>B</code> 是在 contravariant position。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">                  ┌───────────────────────┐</span><br><span class="line">                  │ A: covariant position │</span><br><span class="line">                  └───────────────────────┘</span><br><span class="line">                              ▲</span><br><span class="line">                              │                    ┌───────────────────────────┐</span><br><span class="line">                                                   │ B: contravariant position │</span><br><span class="line">              ┌ ─ ─ ─ ─ ─ ─ ─ ┴ ─ ─ ─ ─ ─ ─ ─ ─    └───────────────────────────┘</span><br><span class="line">                                               │                 ▲</span><br><span class="line">              ├──────────────────────────────────────────────────┴──────────┐</span><br><span class="line">              │                                │                            │</span><br><span class="line">              │                   ┌────────────────────────┐                │</span><br><span class="line"> ┌────────────────────────┐       │ contravariant position │     ┌────────────────────┐</span><br><span class="line"> │ contravariant position │       └────────────────────────┘     │ covariant position │</span><br><span class="line"> └────────────────────────┘                    ▲                 └────────────────────┘</span><br><span class="line">              ▲                    ┌───────────┘                            ▲</span><br><span class="line">              │                    │    ┌───────────────────────────────────┘</span><br><span class="line">              │                    │    │</span><br><span class="line">           ┌────┐       ┌───────▶  A &#x3D;&gt; B</span><br><span class="line">           │    │───────┘</span><br><span class="line">def foo(f: A &#x3D;&gt; B): C</span><br><span class="line">                    │</span><br><span class="line">                    └────────────┐</span><br><span class="line">                                 ▼</span><br><span class="line">                      ┌────────────────────┐</span><br><span class="line">                      │ covariant position │</span><br><span class="line">                      └────────────────────┘</span><br></pre></td></tr></table></figure>

<p>Scala要求类型本身的variant与类型所在位置的variant一致。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// error 1</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Option</span>[+<span class="type">A</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">orElse</span></span>(o: <span class="type">Option</span>[<span class="type">A</span>]): <span class="type">Option</span>[<span class="type">A</span>]</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// error 2</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">V1</span>[+<span class="type">A</span>]</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">V2</span>[-<span class="type">B</span>] <span class="keyword">extends</span> <span class="title">V1</span>[<span class="type">B</span>]</span></span><br></pre></td></tr></table></figure>

<p>这个定义将会导致编译错误，<code>Error:... covariant type A occurs in contravariant position in type</code>。<code>orElse</code> 函数接受参数<code>Option[A]</code>，这个位置（contravariant position）是只能将 <code>A</code> 转换为 <code>A</code> 的子类型的地方。但是类型 <code>A</code> 是 covariant 的，也就是说在所有上下文中，都可安全的把 <code>A</code> 转换为 <code>A</code> 父类。这里出现了冲突。</p>
<p>对于 <code>orElse</code>，解决方式是不使用 <code>A</code>，使用边界限定类型为 <code>A</code> 的父类。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">orElse</span></span>[<span class="type">B</span> &gt;: <span class="type">A</span>](o: <span class="type">Option</span>[<span class="type">B</span>]): <span class="type">Option</span>[<span class="type">B</span>] = <span class="keyword">this</span> <span class="keyword">match</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">None</span> =&gt; ob</span><br><span class="line">    <span class="keyword">case</span> _ =&gt; <span class="keyword">this</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那为什么不，</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">orElse</span></span>[<span class="type">B</span> &lt;: <span class="type">A</span>](o: <span class="type">Option</span>[<span class="type">B</span>]): <span class="type">Option</span>[<span class="type">B</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">orElse</span></span>[<span class="type">B</span>](o: <span class="type">Option</span>[<span class="type">B</span>]): <span class="type">Option</span>[<span class="type">B</span>]</span><br></pre></td></tr></table></figure>

<p><code>orElse</code> 返回值可能的类型为 <code>Option[B]</code> 或 <code>Option[A]</code>，</p>
<ul>
<li>对于1，<code>B</code> 是 <code>A</code> 的子类，<code>Option[B]</code> 是 <code>Option[A]</code> 的子类，当返回 <code>this</code> 时，类型为 <code>Option[A]</code>，这里无法从父类转换到子类。</li>
<li>对于2，当返回 <code>this</code> 时，类型为 <code>Option[A]</code>，和 <code>Option[B]</code> 完全无关，类型不匹配。</li>
</ul>
<h1 id="Laziness-和-Non-strictness"><a href="#Laziness-和-Non-strictness" class="headerlink" title="Laziness 和 Non-strictness"></a>Laziness 和 Non-strictness</h1><p>二者都与求值策略<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Evaluation_strategy">^1</a>（evaluation strategy）有关。一个编程语言用求值策略来，</p>
<ul>
<li>确定合适计算一个函数调用的参数。</li>
<li>以什么样的形式来把数值传递给函数。</li>
</ul>
<p>求值策略包括，</p>
<ul>
<li><p>严格求值（strict evaluation）：一个函数调用的参数总是在应用这个函数之前进行完全求值。常见的有，</p>
<ul>
<li><p>call by value</p>
</li>
<li><p>call by reference</p>
<p>关于这个话题，不得不提的是计算顺序<a target="_blank" rel="noopener" href="http://en.cppreference.com/w/cpp/language/eval_order">^2</a>（order of evaluation），在c++中，这个顺序未定义，由编译器决定。</p>
</li>
</ul>
</li>
<li><p>非严格求值（non-strict evaluation）：一个函数调用的参数只有在函数体内被使用到时，才进行求值。常见有，</p>
<ul>
<li>call by name：在函数体内被使用到时才进行求值，没有被用到则不会求值。如果被多次使用到，那么每次使用都需要重新求值。</li>
<li>call by need：记忆版的 call by name。当参数首次被求值时，值被保留用于后续使用。</li>
</ul>
</li>
<li><p>非确定性策略（nondeterministic strategies）</p>
<ul>
<li>call by future</li>
</ul>
</li>
</ul>
<p>在 Scala 中，非严格参数又叫做 call “by name” 参数，对应 Scala 中对这些参数使用的 call by name求值策略。当首次使用到某个参数的时候，通过 <code>lazy val</code> 缓存这个值，来达到 call by need（又叫做 lazy evaluation）。</p>
<h1 id="Nothing-和-NotNothing"><a href="#Nothing-和-NotNothing" class="headerlink" title="Nothing 和 NotNothing"></a>Nothing 和 NotNothing</h1><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/OlegIlyenko/hacking-scala-blog/blob/master/posts/Advanced-Type-Constraints-with-Type-Classes.md">Advanced Type Constraints with Type Classes</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mongodb/mongo-spark/blob/master/src/main/scala/com/mongodb/spark/NotNothing.scala">NotNothing.scala</a></li>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/41403287/possible-to-make-scala-require-a-non-nothing-generic-method-parameter-and-return">Possible to make scala require a non-Nothing generic method parameter and return to type-safety</a></li>
</ul>
<p>Scala 中，关于多态，一个头疼的<a target="_blank" rel="noopener" href="https://issues.scala-lang.org/browse/SI-2609">问题</a>是，如果没有为一个多态方法指定类型参数，并且无法从方法的参数中推断出类型，由于 <code>Nothing</code> 是所有类型的子类型，此时 Scala 就会把没有指定的类型推断为 <code>Nothing</code>。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sealed</span> <span class="class"><span class="keyword">trait</span> <span class="title">Dimension</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">sealed</span> <span class="title">trait</span> <span class="title">UnitDim</span> <span class="keyword">extends</span> <span class="title">Dimension</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">trait</span> <span class="title">VarDim</span> <span class="keyword">extends</span> <span class="title">Dimension</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">sealed</span> <span class="title">trait</span> <span class="title">DimValue</span>[<span class="type">D</span> &lt;: <span class="type">Dimension</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">value</span></span>: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">DimValue</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>[<span class="type">D</span> &lt;: <span class="type">Dimension</span>](v: <span class="type">Int</span>) = <span class="keyword">new</span> <span class="type">DimValue</span>[<span class="type">D</span>] &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">value</span></span>: <span class="type">Int</span> = v</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的 <code>DimValue</code>，我希望 <code>apply</code> 中，<code>D</code> 为 <code>Dimension</code> 的子类型。如果在调用这个方法时为明确指定类型参数，结果就会是 <code>DimValue[Nothing]</code>。这不是我所期望的。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> dv = <span class="type">DimValue</span>(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="type">Pattern</span>: dv: <span class="type">DimValue</span>[<span class="type">Nothing</span>] <span class="keyword">with</span> <span class="type">Object</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">value</span></span>: <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Google 了 Scala NotNothing 以后，找到两个方法，</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/41403287/possible-to-make-scala-require-a-non-nothing-generic-method-parameter-and-return">Possible to make scala require a non-Nothing generic method parameter and return to type-safety Ask Question</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/OlegIlyenko/hacking-scala-blog/blob/master/posts/Advanced-Type-Constraints-with-Type-Classes.md">Advanced Type Constraints with Type Classes</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mongodb/mongo-spark/blob/master/src/main/scala/com/mongodb/spark/NotNothing.scala">mongodb/mongo-spark</a></li>
<li><a target="_blank" rel="noopener" href="http://baddotrobot.com/blog/2015/07/03/scala-implicit-parameters/">Implicit Parameters in Scala</a></li>
<li><a target="_blank" rel="noopener" href="http://docs.scala-lang.org/tutorials/tour/implicit-parameters.html">Implicit Parameters</a></li>
</ul>
<h1 id="State-Action-and-FSM"><a href="#State-Action-and-FSM" class="headerlink" title="State Action and FSM"></a>State Action and FSM</h1><p><code>type State[S, +A] = S =&gt; (A, S)</code></p>
<p><code>State</code> 代表<em>携带者某种状态的计算</em>，或 state action，state transition，或 statement。<code>State</code> 类型表示将 <code>S</code> 从一个状态转换到另一个状态，并产生副作用 <code>A</code>。这有点像有限状态机。</p>
<p>考虑一个 Mealy 型的 FSM，根据定义（主要是转移函数和输出函数），把这个 FSM 表示为，</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Mealy</span>[<span class="type">S</span>, <span class="type">I</span>, <span class="type">A</span>](<span class="params">t: (<span class="type">S</span>, <span class="type">I</span></span>) <span class="title">=&gt;</span> <span class="title">S</span>, <span class="title">g</span></span>: (<span class="type">S</span>, <span class="type">I</span>) =&gt; <span class="type">A</span>)</span><br></pre></td></tr></table></figure>

<p>其中，</p>
<ul>
<li><code>S</code>：状态的有限集合</li>
<li><code>I</code>：输入字母表的有限集合</li>
<li><code>A</code>：输出字母表的有限集合</li>
<li><code>t</code>：转移函数</li>
<li><code>g</code>：输出函数</li>
</ul>
<p>转移函数和输出函数都接受 <code>S</code> 和 <code>I</code> 的值作为参数，可以把这两个函数合并，得到，</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="type">S</span>, <span class="type">I</span>) =&gt; (<span class="type">A</span>, <span class="type">S</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// currying</span></span><br><span class="line"><span class="type">I</span> =&gt; <span class="type">S</span> =&gt; (<span class="type">A</span>, <span class="type">S</span>)</span><br></pre></td></tr></table></figure>

<p>根据 State 的定义得到，<code>I =&gt; State[S, A]</code>。<code>State[S, A]</code> 代表类型为 <code>S =&gt; (A, S)</code> 的函数，这个函数参数可以看做这个 Mealy 型的 FSM 的初始状态。</p>
<p>同样的一个 Moore 型的 FSM，根据定义可以表示为，</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Moore</span>[<span class="type">S</span>, <span class="type">I</span>, <span class="type">A</span>](<span class="params">t: (<span class="type">S</span>, <span class="type">I</span></span>) <span class="title">=&gt;</span> <span class="title">S</span>, <span class="title">g</span></span>: <span class="type">S</span> =&gt; <span class="type">A</span>)</span><br></pre></td></tr></table></figure>

<p>转移函数和输出函数都接受 <code>S</code> 的值作为参数，合并得到，<code>S =&gt; (I =&gt; S, A)</code>，但此时就不能够用 <code>State</code> 数据类型来表示了。</p>
<h1 id="implicit"><a href="#implicit" class="headerlink" title="implicit"></a>implicit</h1><ul>
<li><a target="_blank" rel="noopener" href="http://akmetiuk.com/posts/2017-05-12-implicits.html">Implicits mechanism in Scala</a></li>
<li><a target="_blank" rel="noopener" href="http://docs.scala-lang.org/tutorials/tour/implicit-parameters.html">Implicit Parameters</a></li>
<li><a target="_blank" rel="noopener" href="http://docs.scala-lang.org/overviews/core/implicit-classes.html">Implicit Classes</a></li>
<li><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/10375633/understanding-implicit-in-scala">Understanding implicit in Scala</a></li>
<li><a target="_blank" rel="noopener" href="http://www.lihaoyi.com/post/ImplicitDesignPatternsinScala.html">Implicit Design Patterns in Scala</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/scala/" rel="tag"># scala</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2017/2017-04-23-scanRight-and-Dynamic-Programming/" rel="prev" title="scanRight和动态规划">
                  <i class="fa fa-chevron-left"></i> scanRight和动态规划
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2018/2018-06-15-notes-of-docker/" rel="next" title="Docker笔记">
                  Docker笔记 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2014 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chao Mai</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{&quot;enable&quot;:true,&quot;tags&quot;:&quot;none&quot;,&quot;js&quot;:{&quot;url&quot;:&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;mathjax@3.1.4&#x2F;es5&#x2F;tex-mml-chtml.js&quot;,&quot;integrity&quot;:&quot;sha256-ncNI9OXOS5Ek4tzVYiOMmN&#x2F;KKCPZ6V0Cpv2P&#x2F;zHntiA&#x3D;&quot;}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{&quot;enable&quot;:true,&quot;shortname&quot;:&quot;chaomaisblog&quot;,&quot;count&quot;:true,&quot;i18n&quot;:{&quot;disqus&quot;:&quot;disqus&quot;}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
